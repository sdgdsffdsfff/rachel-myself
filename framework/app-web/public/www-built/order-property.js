define("app/service/orderPropertyService",["zepto","ajax"],function(e,t){function n(e){t({type:"POST",url:"/api/inventories/"+e.propertyId+"/reserving-schedules",data:e.data,success:e.successCb,error:e.errorCb})}return{orderAjax:n}}),define("app/order-property",["zepto","app/service/orderPropertyService"],function(e,t){function a(){r.on("click",function(){function r(e){e.redirect==""?null:location.href=e.redirect}function u(e){e.redirect==""?i.html(e.message).show():location.href=e.redirect}var e=p(n.val());if(e){i.html(e).show();return}t.orderAjax({propertyId:config.propertyId,data:{phone:n.val().trim(),visit_at:c(s,"date")+" "+c(o,"timedot")},successCb:r,errorCb:u})})}function f(){n.on("focus",function(){i.hide()})}function l(){function r(n){var r=new Date,i=r.getHours(),s=r.getMinutes()+10,u=1,a=n.length,f=1,l,c,p;for(;u<a;u++){l=n[f].innerHTML.split(":"),optionHour=l[0],optionMinute=l[1],s>=60?(i+=1,s-=60):null;if(!(optionHour<i||optionHour==i&&optionMinute<s))break;t?t.push(e(n[f]).remove()):t=[e(n[f]).remove()]}var d=h(o).split(":"),c=d[0],p=d[1];c!="不限"&&(c<i||c==i&&p<s+10)&&(o[0].selectedIndex=0)}var t=null,n=o[0].options.length;s.on("change",function(){var i=this.selectedIndex,s=this.options[i].innerHTML.trim();if(s=="今天")r(o[0].options);else{if(t!=null){for(var u=0;u<t.length;u++)e(o[0].options[u]).after(t[u]);o[0].selectedIndex+t.length>n?null:o[0].selectedIndex+=t.length}t=null}})}function c(t,n){var r=t[0].selectedIndex,i=e(t[0].options[r]).attr(n);return i.trim()}function h(e){var t=e[0].selectedIndex,n=e[0].options[t].innerHTML;return n?n.trim():""}function p(e){var e=e.trim();if(e=="")return"手机号没有输入";var t=/^1\d{10}$/;return t.test(e)?"":"手机号格式错误"}function d(){n.on("input",function(e){e.preventDefault(),n.val()?(u.show(),v(n)):u.hide()})}function v(e){u.tap(function(t){e.val(""),u.hide()})}var n=e("#phoneNum"),r=e("#orderBtn"),i=e("#errorTip"),s=e("#itemDate"),o=e("#itemTimedot"),u=e("#iconcancel");(function(){a(),f(),l(),d()})()}),require(["./common"],function(e){require(["app/order-property"])}),define("../order-property",function(){});